#!/bin/bash
#
# Locates a role file in the ancestry chain and loads it.  This will provide
# a list of formulas to execute.

# Load a role
#
# Parameters:
#     $1: Role to load
#     $2-*: Extra arguments to pass to the role script
# Returns true if there was no error loading the role
wick-load-role() {
    local LOCATION ROLE

    if [[ ${#@} -eq 0 ]]; then
        echo "You must specify a role to load."

        return 1
    fi

    ROLE=$1
    shift

    if ! wick-find LOCATION "roles/$ROLE"; then
        echo "Unable to find role $ROLE"

        return 1
    fi

    echo "Using role $ROLE ($LOCATION $@)"
    WICK_ROLE_DIR=${LOCATION%/*}
    . "$LOCATION" "$@"
}
