#!/bin/bash

wick-explorer() {
    local EXPLORER TEMP

    EXPLORER="formulas/$2/explorers/$3"

    if ! wick-find EXPLORER "$EXPLORER"; then
        wick-error "Unable to find explorer: $EXPLORER"

        return 1
    fi

    # Run the explorer
    temp-directory TEMP

    if ! "$EXPLORER" > "$TEMP/stdout" 2> "$TEMP/stderr"; then
        wick-error "Explorer failed: $EXPLORER"
        wick-debug "$(< "$TEMP/stderr" )"

        return 1
    fi

    local "$1" && wick-indirect "$1" "$(<"$TEMP/stdout")"
}
